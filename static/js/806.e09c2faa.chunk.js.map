{"version":3,"file":"static/js/806.e09c2faa.chunk.js","mappings":"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","sources":["NCAWorker.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["/* eslint-disable no-restricted-globals */\r\nimport * as ort from 'onnxruntime-web'\r\n\r\nconst pwd = `${self.location.origin}`\r\n\r\nclass NCAWorker \r\n{\r\n\tprivate session: ort.InferenceSession | null = null\r\n\r\n\tasync init(model_name: string) {\r\n\t\t// * attempt to load onnx model from file\r\n\t\ttry {\r\n\t\t\tconst path = `${pwd}/models/${model_name}.onnx`\r\n\t\t\tthis.session = await ort.InferenceSession.create(path)\r\n\t\t\t// console.log('[NCAWorker -- init] ONNX model loaded successfully')\r\n\t\t\treturn true\r\n\t\t} \r\n\t\tcatch (error) {\r\n\t\t\tconsole.log([ '[NCAWorker -- init] error! ' + error])\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\tasync run_step(state: Float32Array, size: number) {\r\n\t\t// * assert session is initialized\r\n\t\tif (!this.session) {\r\n\t\t\tconsole.log('[NCAWorker -- run_step] error! model not initialized. call initialize() first')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst input = new ort.Tensor('float32', state, [1, 16, size, size, size])\r\n\t\t\tconst input_feeds = { 'input': input }\r\n            const output = await this.session.run(input_feeds)\r\n            const new_state = output.output.data as Float32Array\r\n            return new_state\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log([ '[NCAWorker -- run_step] error! at inference: ' + error])\r\n\t\t\treturn\r\n\t\t}\r\n\t}\r\n\r\n\tdamage_state(state: Float32Array, size: number): Float32Array {\r\n        const mask = this.createHalfVolumeMask(size)\r\n        const newState = new Float32Array(state.length)\r\n        \r\n        for (let c = 0; c < 16; c++) {\r\n            for (let x = 0; x < size; x++) {\r\n                for (let y = 0; y < size; y++) {\r\n                    for (let z = 0; z < size; z++) {\r\n                        const volumeIndex = x * size * size + y * size + z\r\n                        const stateIndex = (c * size * size * size) + volumeIndex\r\n                        newState[stateIndex] = state[stateIndex] * mask[volumeIndex]\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return newState\r\n    }\r\n\r\n    private createHalfVolumeMask(size: number): Float32Array {\r\n        const maskTypes = ['x+', 'x-', 'y+', 'y-', 'z+', 'z-']\r\n        const type = maskTypes[Math.floor(Math.random() * maskTypes.length)]\r\n        const mat = new Float32Array(size * size * size)\r\n        const half = Math.floor(size / 2)\r\n\r\n        for (let x = 0; x < size; x++) {\r\n            for (let y = 0; y < size; y++) {\r\n                for (let z = 0; z < size; z++) {\r\n                    const index = x * size * size + y * size + z\r\n                    if (\r\n                        (type === 'x+' && x < half) ||\r\n                        (type === 'x-' && x >= half) ||\r\n                        (type === 'y+' && y < half) ||\r\n                        (type === 'y-' && y >= half) ||\r\n                        (type === 'z+' && z < half) ||\r\n                        (type === 'z-' && z >= half)\r\n                    ) {\r\n                        mat[index] = 1.0\r\n                    } else {\r\n                        mat[index] = 0.0\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return mat\r\n    }\r\n}\r\n\r\nconst worker = new NCAWorker()\r\n\r\nonmessage = async (event: MessageEvent) => {\r\n\t// * initialize worker\r\n\tif (event.data.type === 'init') {\r\n\t\tconst data = event.data.data\r\n\t\tconst res = await worker.init(data[0])\r\n\t\tif (res) { postMessage({ type: 'init-complete' }) }\r\n\t\telse { postMessage({ type: 'error', data: 'error! attempting to initialize session' }) }\r\n\r\n\t// * run model step\r\n\t} else if (event.data.type === 'run') {\r\n\t\ttry {\r\n\t\t\tconst data = event.data.data\r\n\t\t\tconst result = await worker.run_step(data[0], data[1])\r\n\t\t\tpostMessage({ type: 'result', data: result })\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log([ '[NCAWorker -- onmessage] error! run step: ' + error])\r\n\t\t\tpostMessage({ type: 'error', data: error })\r\n\t\t}\r\n\r\n\t// * damage state\r\n\t} else if (event.data.type === 'dmg') {\r\n\t\ttry {\r\n\t\t\tconst data = event.data.data\r\n\t\t\tlet dmg_state = worker.damage_state(data[0], data[1])\r\n\t\t\tpostMessage({ type: 'result', data: dmg_state })\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log([ '[NCAWorker -- onmessage] error! damage state: ' + error])\r\n\t\t\tpostMessage({ type: 'error', data: error })\r\n\t\t}\r\n\t}\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [284], () => (__webpack_require__(806)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"01e5d91a\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"/\";","__webpack_require__.b = self.location + \"/../../../\";\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t806: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkbrowser_nca\"] = self[\"webpackChunkbrowser_nca\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(284).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["pwd","self","location","origin","worker","constructor","session","init","model_name","path","this","ort","create","error","console","log","run_step","state","size","input_feeds","output","run","data","damage_state","mask","createHalfVolumeMask","newState","Float32Array","length","c","x","y","z","volumeIndex","stateIndex","maskTypes","type","Math","floor","random","mat","half","index","onmessage","async","event","postMessage","result","dmg_state","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","Object","keys","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","f","e","chunkId","Promise","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","b","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","push","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}